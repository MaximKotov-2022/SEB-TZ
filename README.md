## 3. Работа с внешним API

**Цель:** 
Настроить процесс сбора и сохранения в БД данных о продаже 1 USD и 1 EURO за Российский рубль на ежедневной основе.

**Задачи:**
1. Написать pipeline на Python, который должен:
   * ✅ Забирать данные из API внешнего сервиса с данными о курсах валют
   * ✅ Работать ежедневно в 8 утра по московскому времени
   * ✅ Забирать данные о продаже 1 USD и 1 EURO за Российский рубль. 
   * ✅ Сами данные записывать в таблицу в базе данных 

**Дополнительные условия:**
Можно использовать любой API для получения курсов валют.

**Результат задания:**
1. Pipeline на Python
2. DAG для Airflow, который получает и сохраняет данные + SQL запрос создания таблицы (задание со звездочкой)

**Инструментарий:**
* PostgreSQL + BigQuery + MS SQL Server (то есть тестовое задание можно выполнять на любом из этих диалектов)
* Airflow 2.4
* Python 3.8

**[Файл с решением](https://github.com/MaximKotov-2022/SEB-TZ-3/blob/master/main_3.py)**


### 4. SQL Big Query

**Цель:**
Провести аналитику интернет-магазина с помощью SQL-запросов за период с 1 мая 2017 по 1 августа 2017 года

**Задачи:**
1. ✅ Вывести ТОП 5 самых конверсионных источников / каналов  
2. Вывести список товаров, которые сформировали 80% выручки
3. Вывести сколько в среднем артикулов в одном заказе
4. Вывести количество пользователей, которые совершили покупку в течение первых 3-х визитов на сайт. Какая доля от всех пользователей за тот же самый период.

**Дополнительные условия:**
Сам набор данных находится в Big Query: `bigquery-public-data.google_analytics_sample.ga_sessions_`
Вы можете получить доступ к нему через режим песочницы. Для этого нет необходимости подключать оплату. Более подробную информацию можно узнать тут[1].

**Результат задания**: SQL запросы

**Инструментарий:**
BigQuery (песочница)

**[Файл с решением](https://github.com/MaximKotov-2022/SEB-TZ-3/blob/master/main_4.sql)**

**[Ссылка на решение](https://console.cloud.google.com/bigquery?sq=481397961595:a4742fef0f7b40b58c34db2239988ec1)**